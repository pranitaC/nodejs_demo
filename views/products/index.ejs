<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Demo App</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/bootstrap.css"></link>
    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css"></link>
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="/javascripts/html5shiv.min.js"></script>
      <script src="/javascripts/respond.min.js"></script>
    <![endif]-->
    
  </head>
  <body>
     <%- include('../layouts/bootstrap_header') %>
    <div class="container">
      <div class="row">
        <div class="pull-left">
          <h4>
            Products
          </h4>
        </div>
        <div class="pull-right">
          <a href="/products/new" class="btn btn-info">Add New Product</a>
        </div>
        <div class="clr"></div>
      </div>
      <hr/>
      <table class="table table-bordered">
        <tr>
          <th>Name</th>
          <th>Price</th>		
          <th colspan="3">Actions</th>		
        </tr>
        <% for(var i = 0; i < records.length; i++) { %>
          <tr>
            <td><%= records[i].name %></td>
            <td><%= records[i].price %></td>		
            <td><a href="/products/<%= records[i]._id %>" class="btn btn-info">Show</a></td>
            <td><a href="/products/<%= records[i]._id %>/edit" class="btn btn-info">Edit</a></td>
            <td>
              <form action="/products/<%= records[i]._id %>?_method=DELETE" method='post'>
                <input type="submit" value="Delete" class="btn btn-danger"/>
              </form>
            </td>
          </tr>
        <% } %>
      </table>
      <% var max = 4; %>
      <% var rows = records.length % 4 == 0 ? records.length / 4 : Math.floor(records.length / 4)+1 %>
      <% for(var i = 0; i < rows; i++) { %>
        <div class="row">
          <% var start = i * max; %>
          <% for(var j = start, k = 0; j < records.length; j++,k++) { %>
            <% if(k < max) { %>
              <% var product = records[j]; %>
              <div class="col-lg-3">
                <div class="thumbnail">
                  <a>
                    <img src="<%= product.image_url %>">
                  </a>
                  <div class="caption">
                    <h3><%= product.name %></h3>
                  </div>
                </div>
              </div>
            <% } %>
          <% } %>
        </div>
      <% } %>
    </div>
  </body>
</html>
